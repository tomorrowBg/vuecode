{"version":3,"file":"vue.js","sources":["../src/observe/arr.js","../src/observe/index.js","../src/initState.js","../src/compile/parseAst.js","../src/compile/generate.js","../src/compile/index.js","../src/init.js","../src/index.js"],"sourcesContent":["//重新写数组\r\n//(1) 获取原来的数组方法\r\nlet oldArrayProtoMethods = Array.prototype\r\n\r\n//（2）继承\r\nexport let ArrayMethods = Object.create(oldArrayProtoMethods)\r\n\r\n//劫持\r\n\r\nlet methods = [\r\n    \"push\",\r\n    \"pop\",\r\n    \"unshift\",\r\n    \"shift\",\r\n    \"splice\"\r\n]\r\n\r\nmethods.forEach(item => {\r\n    ArrayMethods[item] = function (...args) { // {list:[]} list.push()\r\n        console.log('劫持数组')\r\n\r\n        let result = oldArrayProtoMethods[item].apply(this, args)\r\n        // console.log(args) // [{b:6}]\r\n        //问题 ：数组追加对象的情况  arr.push({a:1})\r\n        let inserted\r\n        switch (item) {\r\n            case 'push':\r\n            case \"unshift\":\r\n                inserted = args\r\n                break;\r\n             case \"splice\":\r\n                 inserted = args.splice(2); //arr.splice(0,1,{a:6})\r\n                 break;\r\n        }\r\n        // console.log( inserted)\r\n        // console.log(this)\r\n        let ob = this.__ob__ //\r\n        if(inserted){\r\n            ob.observeArray(inserted) // 对我们的添加的对象进行劫持\r\n        }\r\n        return result\r\n    }\r\n})","import {ArrayMethods} from './arr'\r\nexport function observer(data) {\r\n    // console.log(data)\r\n    // 给 data 定义一个属性\r\n  \r\n    //1判断\r\n    if (typeof data != 'object' || data == null) {\r\n        return data;\r\n    }\r\n    // 1对象通过一个类\r\n    return new Observer(data)\r\n}\r\nclass Observer {\r\n    constructor(value) {\r\n        Object.defineProperty(value,\"__ob__\",{\r\n            enumerable:false,\r\n            value:this\r\n        })\r\n         //判断数据\r\n        //  console.log(value)\r\n         if(Array.isArray(value)){ //  list:[1,2,3]\r\n            value.__proto__ = ArrayMethods \r\n            // console.log('数组')\r\n            //如果你是数组对象\r\n             this.observeArray(value) // 处理数组对象 [{a:1}]\r\n         }else{\r\n            this.walk(value)  //遍历\r\n         }\r\n        \r\n    }\r\n    walk(data) { //  {  msg:'hello'，a}\r\n        let keys = Object.keys(data)\r\n        for (let i = 0; i < keys.length; i++) {\r\n\r\n            //对象我们的每个属性进行劫持\r\n            let key = keys[i] //\r\n            let value = data[key]\r\n            defineReactive(data, key, value)\r\n        }\r\n    }\r\n    observeArray(value){ //[{a:1}] \r\n         for(let i = 0 ;i<value.length;i++){\r\n            observer(value[i])\r\n         }\r\n    }\r\n}\r\n//对对象中的属性进行劫持\r\nfunction defineReactive(data, key, value) {  //{a:{b:1}}\r\n    observer(value) //深度代理\r\n    Object.defineProperty(data, key, {\r\n        get() {\r\n            // console.log('获取')\r\n            return value\r\n        },\r\n        set(newValue) {\r\n            // console.log('设置')\r\n            if (newValue == value) return;\r\n            observer(newValue) //如果用户设置的值是对象\r\n            value = newValue\r\n        }\r\n    })\r\n}\r\n   // vue2     Object.defineProperty  缺点  对象中的一个属性   { a:1,b:2}\r\n\r\n   // {a:{}，list:[]}\r\n\r\n   // 总结 ：（1）对象 \r\n   //  1 Object.defineProperty  有缺点 只能 对象中的一个属性 进行劫持  \r\n   //  2 遍历 {a:1,b:2 ,obj:{}}\r\n   //  3 递归  get   set\r\n\r\n\r\n\r\n\r\n   // 2数组 { list:[1,2,3,4], arr:[{a:1}]} \r\n   //  方法函数劫持 ，劫持数组方法  arr.push（1）","import { observer } from \"./observe/index\";\r\n\r\nexport function initState(vm) {\r\n    let opts = vm.$options\r\n    //  console.log(opts)\r\n    //判断\r\n    if (opts.props) {\r\n        initProps(vm)\r\n    }\r\n    if (opts.data) {\r\n        initData(vm)\r\n    }\r\n    if (opts.watch) {\r\n        initWatch()\r\n    }\r\n    if (opts.computed) {\r\n        initComputed()\r\n    }\r\n    if (opts.methods) {\r\n        initMethods()\r\n    }\r\n\r\n}\r\n\r\nfunction initComputed() { }\r\nfunction initMethods() { }\r\nfunction initProps() { }\r\nfunction initWatch() { }\r\n\r\n//vue2 对data初始化  \r\nfunction initData(vm) {\r\n    //  console.log( vm) // （1） 对象  （2） 函数\r\n    let data = vm.$options.data\r\n    data = vm._data = typeof data === \"function\" ? data.call(vm) : data; //注意  this\r\n    //data数据进行劫持\r\n    //将data 上的所有属性代理到 实例上 vm  {a:1,b:2}\r\n    for (let key in data) {\r\n        proxy(vm, \"_data\", key)\r\n    }\r\n    observer(data)\r\n}\r\nfunction proxy(vm,source,key){\r\n    Object.defineProperty(vm,key,{\r\n        get(){\r\n            return vm[source][key]\r\n        },\r\n        set(newValue){\r\n            vm[source][key] = newValue\r\n        }\r\n    })\r\n}\r\n // data{}   (1) 对象  （2）数组    { a:{b:1},list:[1,2,3], arr:[{}]}","/*\r\n * @Author: yyds白 tomorrowBg@163.com\r\n * @Date: 2023-05-18 22:18:02\r\n * @LastEditors: yyds白 tomorrowBg@163.com\r\n * @LastEditTime: 2023-05-18 22:18:02\r\n * @FilePath: \\vue_code\\2.创建ast语法树\\src\\compile\\parseAst.js\r\n * @Description: ast语法树解析\r\n * Copyright (c) 2023 by ${git_name_email}, All Rights Reserved.\r\n */\r\n//<div id=\"app\"> hello {{msg}} <h></h></div>\r\n//ast语法树 {}    vnode {}\r\n\r\n/**\r\n * {\r\n * tag:'div',\r\n * attrs:[{id:\"app\"}],\r\n * children:[{tag:null,text:hello},{tag:'div'}]\r\n * }\r\n * \r\n * \r\n * \r\n * \r\n */\r\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`;   // 标签名称\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; //<span:xx>\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 标签开头的正则 捕获的内容是标签名\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配标签结尾的 </div>\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // 匹配属性的\r\n//<div id=\"app\"></div>\r\nconst startTagClose = /^\\s*(\\/?)>/; // 匹配标签结束的 >\r\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g // {{}}\r\n// 遍历\r\n// 创建ast语法树\r\nfunction createASTElement(tag, attrs) {\r\n    //<div id=\"app\"> hello {{msg}} <h></h></div>\r\n    return {\r\n        tag, // 元素 (div ,span)\r\n        attrs, // 属性\r\n        children: [], // 子节点\r\n        type: 1, // 类型\r\n        parent: null // 是否有父元素\r\n    }\r\n}\r\nlet root; // 根元素\r\nlet createParent; // 当前元素的父元素\r\nlet stack = []; // 数据解构 => 栈 <div id=\"app\"> hello {{msg}} <h></h></div> , [] => 首先匹配到第一个开始标签<div id=\"app\"> 将div添加进数组 [div] => 2. 匹配到<h> 开始标签 添加到数组, [div, h] => 3.匹配到</h> h 的结束标签 将 h从数组中删除, [div], 这样来回循环的数组中最后一个就是父元素 === 有问题\r\nfunction start(tag, attrs) { //开始标签\r\n    console.log(tag, attrs, '开始的标签')\r\n    let element = createASTElement(tag, attrs)\r\n    console.log('element开始标签', element);\r\n    if (!root) {\r\n        root = element\r\n    }\r\n    createParent = element\r\n    stack.push(element)\r\n    console.log('stack', stack);\r\n}\r\nfunction charts(text) { //获取文本\r\n    console.log(text, '文本')\r\n    // 空格\r\n    text = text.replace(/s/g, '')\r\n    if (text) {\r\n        createParent.children.push({\r\n            type: 3,\r\n            text\r\n        })\r\n    }\r\n}\r\nfunction end(tag) { //结束的标签\r\n    console.log(tag, '结束标签1',stack)\r\n    let element = stack.pop() // 获取到最后一个元素\r\n    createParent = stack[stack.length - 1]\r\n    if (createParent) { // 判断是否有闭合标签 </div>\r\n        // 元素得关闭\r\n        element.parent = createParent.tag\r\n        createParent.children.push(element)\r\n    }\r\n}\r\nexport function parseHTML(html) {\r\n    //<div id=\"app\"> hello {{msg}} <h></h></div>  //  开始标签  文本  结束标签\r\n    while (html) { // html  为空结束\r\n        //判断标签 <>\r\n        let textEnd = html.indexOf('<') // 0\r\n        console.log('%c [ textEnd ]-66', 'font-size:13px; background:pink; color:#bf2c9f;', textEnd)\r\n        if (textEnd === 0) { //标签\r\n            //（1） 开始标签\r\n            const startTagMatch = parseStartTag() // 开始标签的内容 {}\r\n            console.log('startTagMatch', startTagMatch); // => {tagName: 'div', attrs: Array(2)}\r\n            if(startTagMatch){\r\n                console.log('2', 2);\r\n                start(startTagMatch.tagName, startTagMatch.attrs)\r\n                continue;\r\n            }\r\n             //结束标签 \r\n            console.log(500)\r\n            let endTagMatch = html.match(endTag)\r\n            console.log('endTagMatch结束标签', endTagMatch);\r\n            if(endTagMatch){\r\n                advance(endTagMatch[0].length)\r\n                end(endTagMatch[1])\r\n                continue;\r\n            }\r\n        }\r\n        console.log(600);\r\n        //文本\r\n        let text\r\n        if (textEnd > 0) {\r\n            console.log(textEnd)\r\n            //获取文本内容\r\n            text = html.substring(0, textEnd)\r\n            console.log(text)\r\n        }\r\n        if (text) {\r\n            advance(text.length)\r\n            charts(text)  \r\n        }\r\n        // break \r\n    }\r\n    function parseStartTag() {\r\n        //\r\n        console.log('1', 1);\r\n        const start = html.match(startTagOpen) // 1结果  2false\r\n        console.log(start, 'start') // => ['<div', 'div', index: 0, input: '<div id=\"app\"> hello {{msg}}</div>', groups: undefined]\r\n        if(start){\r\n             //创建ast 语法树\r\n        let match = {\r\n            tagName: start[1],\r\n            attrs: []\r\n        }\r\n        //删除 开始标签 <div 属性>\r\n        advance(start[0].length) // => <div  id=\"app\"> hello {{msg}}</div> =>  id=\"app\"> hello {{msg}}</div>\r\n        //属性\r\n        //注意  属性有多个,需要遍历\r\n        //注意 >\r\n        let attr // 属性\r\n        let end // 结束标签\r\n        console.log('html.match(startTagClose)结束标签', html.match(startTagClose)); // => null\r\n        console.log('html.match(attribute)属性', html.match(attribute)); // => [' id=\"app\"', 'id', '=', 'app', undefined, undefined, index: 0, input: ' id=\"app\"> hello {{msg}}</div>', groups: undefined]\r\n        while (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\r\n            console.log(attr, 'attr') // 属性\r\n            console.log('html.match(startTagClose)', html.match(startTagClose));\r\n            match.attrs.push({ name: attr[1], value: attr[3] || attr[4] || attr[5] })\r\n            console.log('match', match);\r\n            advance(attr[0].length) // => value=\"12\"> hello {{msg}}</div>\r\n        }\r\n        if (end) {\r\n            console.log(end, 'end')\r\n            advance(end[0].length)\r\n            return match\r\n        }\r\n\r\n        }\r\n    }\r\n    function advance(n) {\r\n        html = html.substring(n)\r\n        console.log(html, 'advance删除')\r\n    }\r\n    console.log('root', root);\r\n    return root\r\n}","/**\r\n * <div id=\"app\" value=\"12\"> hello {{msg}}<h1></h1></div>\r\n * 变为一下解构\r\n * render () { _c 解析标签(1.标签名. 2.属性, 3._v解析文本('hellow' + _s插值表达式就是变量(msg)), 如果有子元素继续直接_c(...))\r\n *  return _c('div', {id: app}, _v('hellow' + _s(msg)), ,_c(...))\r\n * }\r\n*/\r\n// 处理属性\r\nfunction genProps (attrs) {\r\n    let str = ''\r\n    for(let i = 0; i < attrs.length; i++) { // [{name: 'id', value: 'app'}, {name: 'style', value: 'color: red; font-size: 20px'}]\r\n        let attr = attrs[i]\r\n        console.log('attr1', attr);\r\n        if (attr.name === 'style') {\r\n            let obj = {}\r\n            attr.value.split(';').forEach(item => {\r\n                let [key, val] = item.split(':')\r\n                obj[key] = val\r\n            })\r\n            attr.value = obj\r\n        }\r\n        // 拼接\r\n        str += `${attr.name}:${JSON.stringify(attr.value)},`\r\n    }\r\n    // str => {id:\"app\",style:{\"color\":\" red\",\" font-size\":\" 20px\"}}\r\n    return `{${str.slice(0, -1)}}`\r\n}\r\nexport function generate (el) {\r\n    console.log('generateel', el);\r\n    // 注意属性(行内属性中多个属性是用;分号连接得) attrs: [{name: 'id', value: 'app'}, {name: 'style', value: 'color: red; font-size: 20px'}]\r\n    let code = `_c(${el.tag}, ${el.attrs.length ? `${genProps(el.attrs)}`: 'null'})`\r\n    console.log('code', code);\r\n}","import {parseHTML} from './parseAst'\r\nimport {generate} from './generate'\r\nexport function compileToFunction(el) {\r\n    console.log('el', el);\r\n    // 1.将html变成ast语法树\r\n    let ast = parseHTML(el)\r\n    // console.log('ast', ast);\r\n    // 2.ast 语法树变成render 函数分为俩步: (1)ast语法树变成字符串 (2)字符串变成函数\r\n    let code = generate(ast)\r\n}\r\n/**\r\n * <div id=\"app\" value=\"12\"> hello {{msg}}<h1></h1></div>\r\n * 变为一下解构\r\n * render () { _c 解析标签(1.标签名. 2.属性, 3._v解析文本('hellow' + _s插值表达式就是变量(msg)), 如果有子元素继续直接_c(...))\r\n *  return _c('div', {id: app}, _v('hellow' + _s(msg)), ,_c(...))\r\n * }\r\n*/","/*\r\n * @Author: yyds白 11935851+yyds-white@user.noreply.gitee.com\r\n * @Date: 2023-05-11 20:55:45\r\n * @LastEditors: yyds白 11935851+yyds-white@user.noreply.gitee.com\r\n * @LastEditTime: 2023-05-11 21:09:05\r\n * @FilePath: \\vue_code\\2.创建ast语法树\\src\\init.js\r\n * @Description: 初始化文件方法\r\n * Copyright (c) 2023 by ${git_name_email}, All Rights Reserved.\r\n */\r\nimport { initState } from './initState'\r\nimport { compileToFunction } from './compile/index';\r\nexport function initMixin(Vue) {\r\n    Vue.prototype._init = function (options) {\r\n        // console.log(options)\r\n        let vm = this\r\n        vm.$options = options\r\n        //初始化状态\r\n        initState(vm)\r\n\r\n        //渲染模板  el \r\n        if (vm.$options.el) {\r\n            vm.$mount(vm.$options.el)\r\n        }\r\n    }\r\n    //创建 $mount\r\n\r\n    Vue.prototype.$mount = function (el) {\r\n        console.log(el)\r\n        // el template  render\r\n        let vm = this\r\n        el = document.querySelector(el) //获取元素\r\n        let options = vm.$options\r\n        if (!options.render) { //没有\r\n            let template = options.template\r\n            if (!template && el) {\r\n                //获取html\r\n                el = el.outerHTML\r\n                console.log(el)\r\n\r\n                //<div id=\"app\"> hello {{msg}}</div>\r\n                //变成ast语法树\r\n                console.log('el', el);\r\n               let ast =  compileToFunction(el)\r\n               //render()\r\n\r\n               //\r\n            }\r\n        }\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\n","import { initMixin } from \"./init\";\r\n\r\nfunction Vue(options){\r\n   \r\n     //初始化\r\n     this._init(options)\r\n}\r\n\r\n  initMixin(Vue)\r\nexport default Vue"],"names":["oldArrayProtoMethods","Array","prototype","ArrayMethods","Object","create","methods","forEach","item","console","log","args","result","apply","inserted","splice","ob","__ob__","observeArray","observer","data","Observer","value","defineProperty","enumerable","isArray","__proto__","walk","keys","i","length","key","defineReactive","get","set","newValue","initState","vm","opts","$options","props","initData","watch","computed","_data","call","proxy","source","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","createASTElement","tag","attrs","children","type","parent","root","createParent","stack","start","element","push","charts","text","replace","end","pop","parseHTML","html","textEnd","indexOf","startTagMatch","parseStartTag","tagName","endTagMatch","match","advance","substring","attr","name","n","genProps","str","obj","split","val","JSON","stringify","slice","generate","el","code","compileToFunction","ast","initMixin","Vue","_init","options","$mount","document","querySelector","render","template","outerHTML"],"mappings":"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"}